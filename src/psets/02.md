# Problem Set 2

## Problem 1 [Homework]: Classical Harmonic Oscillator I

<!--- ANCHOR: aufgabe_1 --->
The equation of motion of a harmonic oscillator is given by the second-order 
differential equation
$$
\begin{equation}
    \frac{\du^2 x}{\du t^2} = -\omega^2 x\,,
\end{equation}
$$
where $\omega = \sqrt{k / \mu}$. To solve this equation using the Euler method,
we first need to transform it into a system of first-order differential equations.

**(a) Transformation into a system of first-order differential equations**

Show that the above differential equation can be transformed into the system of
coupled first-order differential equations
$$
\begin{align}
    \frac{\du x}{\du t} &= v \\
    \frac{\du v}{\du t} &= -\omega^2 x
\end{align}
$$
by using the substitution $v = \frac{\du x}{\du t}$.

**(b) Implementation of the Euler method**

Implement the Euler method to solve the system of first-order 
differential equations from part (a). Follow the approach from the lecture 
by implementing the functions `dfdt`, which computes the right-hand side 
of the differential equations, `euler_step`, which performs one step of the 
Euler method, and `euler_method`, which executes the Euler method 
for a given number of steps.

```admonish tip title="Tip"
Similar to the kinetics of the BZ reaction, the solution of the 
harmonic oscillator has two components, $x(t)$ and $v(t)$, whose derivatives 
can be stored in an array 
`[dxdt, dvdt]`.
```

<!-- 
Lösung:
```python
{{include ../codes/02-differential_equations/exercise_02.py:exercise_01_b}}
```
-->

**(c) Derivation of the analytical solution**

Show that the analytical solution of the equation of motion of the harmonic oscillator
with initial conditions $x(0) = x_0$ and $v(0) = v_0$ is given by
$$
\begin{align}
    x(t) = & \frac{v_0}{\omega} \sin(\omega t) + x_0 \cos(\omega t) \\
    v(t) = & v_0 \cos(\omega t) - x_0 \omega \sin(\omega t)\,.
\end{align}
$$
You can use the Ansatz $x(t) = A \sin(\omega t) + B \cos(\omega t)$.

Plot the analytical solution and the numerical solution of the Euler method for
the initial conditions $x_0 = 1$, $v_0 = 0$, $\omega = 1$ with a step size of $dt = 0.1$
for $t \in [0, 10]$. What do you observe?

<!-- 
Lösung:
```python
{{include ../codes/02-differential_equations/exercise_02.py:exercise_01_c}}
```
-->

<!--- ANCHOR_END: aufgabe_1 --->

## Problem 2: Classical Harmonic Oscillator II

The Euler method provides a stable solution for the equation of motion 
of the harmonic oscillator, but it is not very accurate. We could reduce 
the step size $dt$ to improve the accuracy, but we will now test how the classical
Runge-Kutta method (RK4) compares to the Euler method.

Implement the classical Runge-Kutta method of order 4 using the following
Butcher tableau
$$
  \begin{array}{c|cccc}
    0 & 0 & 0 & 0 & 0 \\
    1/2 & 1/2 & 0 & 0 & 0 \\
    1/2 & 0 & 1/2 & 0 & 0 \\
    1 & 0 & 0 & 1 & 0 \\ \hline
      & 1/6 & 1/3 & 1/3 & 1/6
  \end{array}
$$
and solve the system of differential equations of the classical harmonic oscillator
from the previous problem with the parameter $\omega = 1$, the initial conditions
$x_0 = 1$, $v_0 = 0$, and a step size of $\du t = 0.1$ for $t \in [0, 10]$. Plot the 
numerical solution and compare it with the solution of the Euler method, as well as the
analytical solution.

<!-- 
Lösung:
```python
{{include ../codes/02-differential_equations/exercise_02.py:exercise_02}}
```
-->

<!--- ANCHOR_END: aufgabe_2 --->


## Problem 3: Particle in a (Strange) Box

<!--- ANCHOR: aufgabe_3 --->

```admonish warning title="Warning"
This problem is still under construction. Please do not start working on it yet.
```

In the lecture, we applied the finite difference method to solve the
Schrödinger equation for a quantum harmonic oscillator. In this exercise, we will
use it to investigate the particle in a box model, but with a twist.

**(a) Solution of the Schrödinger equation for a particle in a box**

The potential energy of a particle in a box is given by
$$
\begin{equation}
    V(x) = \begin{cases}
        0 & \text{for } 0 < x < L \\
        \infty & \text{otherwise}
    \end{cases}
\end{equation}
$$
where $L$ is the length of the box. 

Apply the finite difference method to solve the time-independent
Schrödinger equation for a particle in a box with $L = 4$.
Use a uniform grid with $N = 512$ points from $x = -0.5$ to $x = 4.5$.

Compare the numerical eigenenergies of the first 20 states with the analytical
eigenenergies.

```admonish tip title="Hint"
Since infinity is not a number, you can set the potential to a very large value,
e.g. $V(x) = 10000$ for $x < 0$ and $x > L$.
```

**(b) Particle in a box with a step potential**

Now we will add a step potential to the box. The potential energy is given by
$$
\begin{equation}
    V(x) = \begin{cases}
        0 & \text{for } 0 < x < a \\
        V_0 & \text{for } a < x < L \\
        \infty & \text{otherwise}
    \end{cases}\,.
\end{equation}
$$

Apply the finite difference method to solve the time-independent
Schrödinger equation for the potential defined above,
parametrised by $L = 4$, $a = 2$, and $V_0 = 10$. 
Use a uniform grid with $N = 512$ points from $x = -0.5$ to $x = 4.5$.

Plot the potential along with the first 5 eigenfunctions
displaced in the vertical direction by their respective eigenenergies.

**(c) The poor man's double well potential**

Consider the potential
$$
\begin{equation}
    V(x) = \begin{cases}
        0 & \text{for } 0 < x < a \\
        V_0 & \text{for } a < x < b \\
        V' & \text{for } b < x < L \\
        \infty & \text{otherwise}
    \end{cases}\,.
\end{equation}
$$

Apply the finite difference method to solve the time-independent
Schrödinger equation for the potential defined above,
parametrised by $L = 4$, $a = 1.5$, $b = 2.5$, $V_0 = 10$, and $V' = 2$.
Use a uniform grid with $N = 512$ points from $x = -0.5$ to $x = 4.5$.

Plot the potential along with the first 5 eigenfunctions
displaced in the vertical direction by their respective eigenenergies.

**(d) Higher-order finite difference method**

The second derivative can be better approximated using more steps 
around the point of interest, e.g.
$$
\begin{equation}
  y''(x) \approx \frac{1}{h^2} \left( 
    -\frac{1}{12} y(x - 2h) 
    + \frac{4}{3} y(x - h) 
    - \frac{5}{2} y(x) 
    + \frac{4}{3} y(x + h) 
    - \frac{1}{12} y(x + 2h)
\right)\,.
\end{equation}
$$

Derive the matrix representation of this finite difference approximation
analogous to Eq. {{eqref: eq:second_finite_difference_symmetric_second_order_matrix}}.
Solve the time-independent Schrödinger equation for a particle in a box 
with the same parameters as in part (a) using this new matrix representation.
Compare the eigenvalues of the first 20 states with the results from part (a) 
and the analytical solution.

